<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 Telemetry Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #ffffff;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(90deg, #e10600 0%, #ffffff 50%, #e10600 100%);
            color: #000000;
            padding: 20px;
            text-align: center;
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: auto auto auto auto;
            gap: 20px;
            padding: 20px;
            min-height: 100vh;
        }

        .panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .panel h3 {
            color: #e10600;
            margin-bottom: 15px;
            font-size: 1.2em;
            text-align: center;
            border-bottom: 2px solid #e10600;
            padding-bottom: 5px;
        }

        .telemetry-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .telemetry-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .telemetry-label {
            font-size: 0.9em;
            color: #cccccc;
            margin-bottom: 5px;
        }

        .telemetry-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffffff;
        }

        .speed-value {
            color: #00ff00;
            font-size: 2em;
        }

        .rpm-value {
            color: #ff6b6b;
        }

        .gear-value {
            color: #4ecdc4;
            font-size: 2em;
        }

        .track-container {
            grid-column: 1 / -1;
            height: 400px;
            position: relative;
            background: #000000;
            border-radius: 15px;
            overflow: hidden;
        }

        .track-svg {
            width: 100%;
            height: 100%;
        }

        .car-position {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #e10600;
            border-radius: 50%;
            border: 3px solid #ffffff;
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 0 20px #e10600;
            transition: all 0.1s ease;
        }

        .predicted-path {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #00ff00;
            border-radius: 50%;
            opacity: 0.7;
            z-index: 5;
        }

        .tire-temps {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .tire-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .tire-label {
            font-size: 0.8em;
            color: #cccccc;
            margin-bottom: 5px;
        }

        .tire-temp {
            font-size: 1.2em;
            font-weight: bold;
        }

        .temp-hot { color: #ff4444; }
        .temp-warm { color: #ffaa44; }
        .temp-cool { color: #44ff44; }

        .status-indicators {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }

        .status-item {
            text-align: center;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin: 0 auto 5px;
        }

        .status-active { background: #00ff00; }
        .status-inactive { background: #666666; }

        .fuel-bar {
            width: 100%;
            height: 20px;
            background: #333333;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .fuel-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000 0%, #ffff00 50%, #00ff00 100%);
            transition: width 0.3s ease;
        }

        .race-progress {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: #333333;
            border-radius: 12px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #e10600 0%, #ff6b6b 50%, #e10600 100%);
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        .leaderboard {
            max-height: 300px;
            overflow-y: auto;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 5px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border-left: 4px solid #e10600;
        }

        .leaderboard-item.current-driver {
            border-left-color: #00ff00;
            background: rgba(0, 255, 0, 0.1);
        }

        .driver-position {
            font-weight: bold;
            color: #e10600;
            min-width: 30px;
        }

        .driver-name {
            flex: 1;
            margin: 0 10px;
            font-weight: bold;
        }

        .driver-lap {
            color: #cccccc;
            font-size: 0.9em;
        }

        .pace-comparison {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
        }

        .pace-item {
            text-align: center;
            flex: 1;
        }

        .pace-value {
            font-size: 1.2em;
            font-weight: bold;
            margin: 5px 0;
        }

        .pace-current { color: #ffffff; }
        .pace-best { color: #00ff00; }
        .pace-delta { color: #ff6b6b; }

        .race-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.8em;
            color: #cccccc;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #ffffff;
        }

        .chart-container {
            position: relative;
            height: 200px;
            margin-top: 15px;
        }

        .lap-timer {
            font-size: 3em;
            color: #e10600;
            text-align: center;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        @media (max-width: 1200px) {
            .dashboard-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .dashboard-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">F1 TELEMETRY DASHBOARD</div>
    
    <div class="lap-timer" id="lap-timer">1:23.456</div>
    
    <div class="dashboard-container">
        <!-- Speed and RPM Panel -->
        <div class="panel">
            <h3>SPEED & RPM</h3>
            <div class="telemetry-grid">
                <div class="telemetry-item">
                    <div class="telemetry-label">SPEED</div>
                    <div class="telemetry-value speed-value" id="speed">0</div>
                    <div class="telemetry-label">km/h</div>
                </div>
                <div class="telemetry-item">
                    <div class="telemetry-label">RPM</div>
                    <div class="telemetry-value rpm-value" id="rpm">0</div>
                </div>
                <div class="telemetry-item">
                    <div class="telemetry-label">GEAR</div>
                    <div class="telemetry-value gear-value" id="gear">1</div>
                </div>
                <div class="telemetry-item">
                    <div class="telemetry-label">SECTOR</div>
                    <div class="telemetry-value" id="sector">1</div>
                </div>
            </div>
        </div>

        <!-- Controls Panel -->
        <div class="panel">
            <h3>DRIVER CONTROLS</h3>
            <div class="telemetry-grid">
                <div class="telemetry-item">
                    <div class="telemetry-label">THROTTLE</div>
                    <div class="telemetry-value" id="throttle">0%</div>
                </div>
                <div class="telemetry-item">
                    <div class="telemetry-label">BRAKE</div>
                    <div class="telemetry-value" id="brake">0%</div>
                </div>
                <div class="telemetry-item">
                    <div class="telemetry-label">STEERING</div>
                    <div class="telemetry-value" id="steering">0.0°</div>
                </div>
                <div class="telemetry-item">
                    <div class="telemetry-label">DRS</div>
                    <div class="telemetry-value" id="drs">OFF</div>
                </div>
            </div>
            <div class="status-indicators">
                <div class="status-item">
                    <div class="status-dot status-inactive" id="drs-indicator"></div>
                    <div class="telemetry-label">DRS</div>
                </div>
                <div class="status-item">
                    <div class="status-dot status-active" id="ers-indicator"></div>
                    <div class="telemetry-label">ERS</div>
                </div>
            </div>
        </div>

        <!-- Fuel and Systems Panel -->
        <div class="panel">
            <h3>FUEL & SYSTEMS</h3>
            <div class="telemetry-item">
                <div class="telemetry-label">FUEL REMAINING</div>
                <div class="telemetry-value" id="fuel">100.0</div>
                <div class="fuel-bar">
                    <div class="fuel-fill" id="fuel-bar"></div>
                </div>
            </div>
            <div class="telemetry-item" style="margin-top: 15px;">
                <div class="telemetry-label">ERS MODE</div>
                <div class="telemetry-value" id="ers-mode">Medium</div>
            </div>
        </div>

        <!-- Track Visualization -->
        <div class="panel track-container">
            <h3 style="position: absolute; top: 10px; left: 20px; z-index: 5;">TRACK POSITION</h3>
            <svg class="track-svg" id="track-svg"></svg>
            <div class="car-position" id="car-position"></div>
        </div>

        <!-- Tire Temperatures -->
        <div class="panel">
            <h3>TIRE TEMPERATURES</h3>
            <div class="tire-temps">
                <div class="tire-item">
                    <div class="tire-label">FL</div>
                    <div class="tire-temp" id="tire-fl">85°C</div>
                </div>
                <div class="tire-item">
                    <div class="tire-label">FR</div>
                    <div class="tire-temp" id="tire-fr">87°C</div>
                </div>
                <div class="tire-item">
                    <div class="tire-label">RL</div>
                    <div class="tire-temp" id="tire-rl">83°C</div>
                </div>
                <div class="tire-item">
                    <div class="tire-label">RR</div>
                    <div class="tire-temp" id="tire-rr">86°C</div>
                </div>
            </div>
        </div>

        <!-- Tire Pressures -->
        <div class="panel">
            <h3>TIRE PRESSURES</h3>
            <div class="tire-temps">
                <div class="tire-item">
                    <div class="tire-label">FL</div>
                    <div class="tire-temp" id="pressure-fl">22.1</div>
                </div>
                <div class="tire-item">
                    <div class="tire-label">FR</div>
                    <div class="tire-temp" id="pressure-fr">22.3</div>
                </div>
                <div class="tire-item">
                    <div class="tire-label">RL</div>
                    <div class="tire-temp" id="pressure-rl">21.8</div>
                </div>
                <div class="tire-item">
                    <div class="tire-label">RR</div>
                    <div class="tire-temp" id="pressure-rr">22.0</div>
                </div>
            </div>
        </div>

        <!-- Race Progress -->
        <div class="panel">
            <h3>RACE PROGRESS</h3>
            <div class="race-progress">
                <div class="telemetry-label">RACE COMPLETION</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="race-progress-fill">
                        <div class="progress-text" id="race-progress-text">0%</div>
                    </div>
                </div>
                <div class="race-stats">
                    <div class="stat-item">
                        <div class="stat-label">CURRENT LAP</div>
                        <div class="stat-value" id="current-lap">1</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">TOTAL LAPS</div>
                        <div class="stat-value" id="total-laps">58</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lap Pace Tracker -->
        <div class="panel">
            <h3>LAP PACE</h3>
            <div class="pace-comparison">
                <div class="pace-item">
                    <div class="telemetry-label">CURRENT LAP</div>
                    <div class="pace-value pace-current" id="current-lap-time">1:23.456</div>
                </div>
                <div class="pace-item">
                    <div class="telemetry-label">BEST LAP</div>
                    <div class="pace-value pace-best" id="best-lap-time">1:22.123</div>
                </div>
                <div class="pace-item">
                    <div class="telemetry-label">DELTA</div>
                    <div class="pace-value pace-delta" id="lap-delta">+1.333</div>
                </div>
            </div>
            <div class="race-stats">
                <div class="stat-item">
                    <div class="stat-label">AVG LAP TIME</div>
                    <div class="stat-value" id="avg-lap-time">1:24.567</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">LAP COUNT</div>
                    <div class="stat-value" id="lap-count">1/58</div>
                </div>
            </div>
        </div>

        <!-- Leaderboard -->
        <div class="panel">
            <h3>LEADERBOARD</h3>
            <div class="leaderboard" id="leaderboard">
                <!-- Leaderboard items will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // F1 Telemetry Data Generator
        class F1TelemetryGenerator {
            constructor() {
                this.lapTime = 0;
                this.sector = 1;
                this.position = { x: 0, y: 0 };
                this.speed = 0;
                this.rpm = 0;
                this.gear = 1;
                this.throttle = 0;
                this.brake = 0;
                this.steering = 0;
                this.drs = false;
                this.ersDeployMode = "Medium";
                this.fuelRemaining = 100;
                this.tireTemps = { fl: 85, fr: 87, rl: 83, rr: 86 };
                this.tirePressures = { fl: 22.1, fr: 22.3, rl: 21.8, rr: 22.0 };
                this.trackRadius = 200;
                this.centerX = 300;
                this.centerY = 200;
                this.angle = 0;
                this.predictedPath = [];
                
                // Race tracking
                this.currentLap = 1;
                this.totalLaps = 58;
                this.bestLapTime = 82.123; // 1:22.123
                this.lapTimes = [];
                this.raceStartTime = Date.now();
                this.lastLapTime = 0;
                this.drivers = this.generateDrivers();
            }

            generateDrivers() {
                const driverNames = [
                    "VER", "LEC", "NOR", "RUS", "PER", "SAI", "HAM", "ALO", 
                    "OCO", "BOT", "GAS", "STR", "ALB", "MAG", "TSU", "HUL",
                    "ZHO", "RIC", "PIA", "SAR"
                ];
                
                return driverNames.map((name, index) => ({
                    name: name,
                    position: index + 1,
                    currentLap: Math.floor(Math.random() * 3) + 1,
                    lapTime: 82 + Math.random() * 5, // 1:22-1:27
                    isCurrentDriver: index === 0
                }));
            }

            generateTelemetry() {
                // Simulate lap progression
                this.lapTime += 0.1;
                this.angle += 0.02;

                // Check for lap completion
                if (this.angle >= 2 * Math.PI) {
                    this.completeLap();
                    this.angle = 0;
                }

                // Generate track position (oval track)
                this.position.x = this.centerX + this.trackRadius * Math.cos(this.angle);
                this.position.y = this.centerY + this.trackRadius * Math.sin(this.angle);

                // Update sector based on angle
                if (this.angle < Math.PI * 2/3) {
                    this.sector = 1;
                } else if (this.angle < Math.PI * 4/3) {
                    this.sector = 2;
                } else {
                    this.sector = 3;
                }

                // Generate realistic telemetry data
                this.speed = Math.floor(180 + Math.sin(this.angle * 2) * 50 + Math.random() * 20);
                this.rpm = Math.floor(8000 + (this.speed / 320) * 4000 + Math.random() * 200);
                this.gear = Math.min(8, Math.max(1, Math.floor(this.speed / 40)));
                this.throttle = Math.floor(20 + Math.random() * 80);
                this.brake = this.speed > 200 ? Math.floor(Math.random() * 80) : 0;
                this.steering = (Math.random() - 0.5) * 0.6;
                this.drs = Math.random() > 0.7 && this.speed > 250;
                this.fuelRemaining = Math.max(0, this.fuelRemaining - Math.random() * 0.2);

                // Tire temperature simulation
                Object.keys(this.tireTemps).forEach(tire => {
                    this.tireTemps[tire] += (Math.random() - 0.5) * 4;
                    this.tireTemps[tire] = Math.max(60, Math.min(120, this.tireTemps[tire]));
                });

                // Tire pressure simulation
                Object.keys(this.tirePressures).forEach(tire => {
                    this.tirePressures[tire] += (Math.random() - 0.5) * 0.2;
                    this.tirePressures[tire] = Math.max(20.0, Math.min(24.0, this.tirePressures[tire]));
                });

                // Update drivers' lap times
                this.updateDrivers();

                return {
                    lapTime: this.lapTime,
                    sector: this.sector,
                    position: this.position,
                    speed: this.speed,
                    rpm: this.rpm,
                    gear: this.gear,
                    throttle: this.throttle,
                    brake: this.brake,
                    steering: this.steering,
                    drs: this.drs,
                    ersDeployMode: this.ersDeployMode,
                    fuelRemaining: this.fuelRemaining,
                    tireTemps: this.tireTemps,
                    tirePressures: this.tirePressures,
                    currentLap: this.currentLap,
                    totalLaps: this.totalLaps,
                    bestLapTime: this.bestLapTime,
                    drivers: this.drivers
                };
            }

            completeLap() {
                this.currentLap++;
                const lapTime = this.lapTime;
                this.lapTimes.push(lapTime);
                
                // Update best lap time
                if (lapTime < this.bestLapTime) {
                    this.bestLapTime = lapTime;
                }
                
                this.lapTime = 0;
            }

            updateDrivers() {
                // Simulate other drivers progressing
                this.drivers.forEach((driver, index) => {
                    if (!driver.isCurrentDriver) {
                        // Randomly advance other drivers
                        if (Math.random() < 0.001) { // 0.1% chance per update
                            driver.currentLap++;
                            driver.lapTime = 82 + Math.random() * 5;
                        }
                    }
                });
            }
        }

        // Initialize telemetry generator
        const telemetryGen = new F1TelemetryGenerator();

        // Initialize track visualization
        function initTrack() {
            const svg = document.getElementById('track-svg');
            const trackRadius = 200;
            const centerX = 300;
            const centerY = 200;

            // Create track path (oval)
            const trackPoints = [];
            for (let i = 0; i < 100; i++) {
                const angle = (i / 100) * 2 * Math.PI;
                const x = centerX + trackRadius * Math.cos(angle);
                const y = centerY + trackRadius * Math.sin(angle);
                trackPoints.push({ x, y });
            }

            // Draw track
            let pathData = `M ${trackPoints[0].x} ${trackPoints[0].y}`;
            for (let i = 1; i < trackPoints.length; i++) {
                pathData += ` L ${trackPoints[i].x} ${trackPoints[i].y}`;
            }
            pathData += ' Z';

            const trackPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            trackPath.setAttribute('d', pathData);
            trackPath.setAttribute('fill', 'none');
            trackPath.setAttribute('stroke', '#333333');
            trackPath.setAttribute('stroke-width', '20');
            svg.appendChild(trackPath);

            // Add sector markers
            const sectors = [
                { start: 0, end: 33, name: 'S1' },
                { start: 33, end: 66, name: 'S2' },
                { start: 66, end: 100, name: 'S3' }
            ];

            sectors.forEach((sector, index) => {
                const startPoint = trackPoints[sector.start];
                const sectorMarker = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                sectorMarker.setAttribute('cx', startPoint.x);
                sectorMarker.setAttribute('cy', startPoint.y);
                sectorMarker.setAttribute('r', '8');
                sectorMarker.setAttribute('fill', '#e10600');
                svg.appendChild(sectorMarker);

                // Add sector labels
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', startPoint.x);
                label.setAttribute('y', startPoint.y - 15);
                label.setAttribute('text-anchor', 'middle');
                label.setAttribute('fill', '#ffffff');
                label.setAttribute('font-size', '12');
                label.setAttribute('font-weight', 'bold');
                label.textContent = sector.name;
                svg.appendChild(label);
            });
        }

        function updateTelemetry(data) {
            // Update speed and RPM
            document.getElementById('speed').textContent = data.speed;
            document.getElementById('rpm').textContent = data.rpm.toLocaleString();
            document.getElementById('gear').textContent = data.gear;
            document.getElementById('sector').textContent = data.sector;

            // Update lap timer
            const minutes = Math.floor(data.lapTime / 60);
            const seconds = (data.lapTime % 60).toFixed(3);
            document.getElementById('lap-timer').textContent = `${minutes}:${seconds.padStart(6, '0')}`;

            // Update controls
            document.getElementById('throttle').textContent = data.throttle + '%';
            document.getElementById('brake').textContent = data.brake + '%';
            document.getElementById('steering').textContent = (data.steering * 10).toFixed(1) + '°';
            document.getElementById('drs').textContent = data.drs ? 'ON' : 'OFF';

            // Update DRS indicator
            const drsIndicator = document.getElementById('drs-indicator');
            drsIndicator.className = `status-dot ${data.drs ? 'status-active' : 'status-inactive'}`;

            // Update fuel
            document.getElementById('fuel').textContent = data.fuelRemaining.toFixed(1);
            document.getElementById('fuel-bar').style.width = data.fuelRemaining + '%';

            // Update ERS mode
            document.getElementById('ers-mode').textContent = data.ersDeployMode;

            // Update tire temperatures
            Object.keys(data.tireTemps).forEach(tire => {
                const element = document.getElementById(`tire-${tire}`);
                const temp = data.tireTemps[tire];
                element.textContent = temp.toFixed(0) + '°C';

                // Color coding for temperature
                element.className = 'tire-temp';
                if (temp > 100) element.classList.add('temp-hot');
                else if (temp > 80) element.classList.add('temp-warm');
                else element.classList.add('temp-cool');
            });

            // Update tire pressures
            Object.keys(data.tirePressures).forEach(tire => {
                const element = document.getElementById(`pressure-${tire}`);
                element.textContent = data.tirePressures[tire].toFixed(1);
            });

            // Update race progress
            updateRaceProgress(data);

            // Update lap pace
            updateLapPace(data);

            // Update leaderboard
            updateLeaderboard(data.drivers);

            // Update car position
            updateCarPosition(data.position);

            // Generate predicted path
            generatePredictedPath(data.position);
        }

        function updateRaceProgress(data) {
            const raceProgress = (data.currentLap / data.totalLaps) * 100;
            document.getElementById('race-progress-fill').style.width = raceProgress + '%';
            document.getElementById('race-progress-text').textContent = raceProgress.toFixed(1) + '%';
            document.getElementById('current-lap').textContent = data.currentLap;
            document.getElementById('total-laps').textContent = data.totalLaps;
        }

        function updateLapPace(data) {
            // Current lap time
            const currentLapTime = data.lapTime;
            const minutes = Math.floor(currentLapTime / 60);
            const seconds = (currentLapTime % 60).toFixed(3);
            document.getElementById('current-lap-time').textContent = `${minutes}:${seconds.padStart(6, '0')}`;

            // Best lap time
            const bestMinutes = Math.floor(data.bestLapTime / 60);
            const bestSeconds = (data.bestLapTime % 60).toFixed(3);
            document.getElementById('best-lap-time').textContent = `${bestMinutes}:${bestSeconds.padStart(6, '0')}`;

            // Delta time
            const delta = currentLapTime - data.bestLapTime;
            const deltaMinutes = Math.floor(Math.abs(delta) / 60);
            const deltaSeconds = (Math.abs(delta) % 60).toFixed(3);
            const deltaText = delta >= 0 ? `+${deltaMinutes}:${deltaSeconds.padStart(6, '0')}` : `-${deltaMinutes}:${deltaSeconds.padStart(6, '0')}`;
            document.getElementById('lap-delta').textContent = deltaText;

            // Average lap time
            if (data.lapTimes && data.lapTimes.length > 0) {
                const avgLapTime = data.lapTimes.reduce((sum, time) => sum + time, 0) / data.lapTimes.length;
                const avgMinutes = Math.floor(avgLapTime / 60);
                const avgSeconds = (avgLapTime % 60).toFixed(3);
                document.getElementById('avg-lap-time').textContent = `${avgMinutes}:${avgSeconds.padStart(6, '0')}`;
            }

            // Lap count
            document.getElementById('lap-count').textContent = `${data.currentLap}/${data.totalLaps}`;
        }

        function updateLeaderboard(drivers) {
            const leaderboard = document.getElementById('leaderboard');
            leaderboard.innerHTML = '';

            drivers.forEach((driver, index) => {
                const driverElement = document.createElement('div');
                driverElement.className = `leaderboard-item ${driver.isCurrentDriver ? 'current-driver' : ''}`;
                
                const lapTimeMinutes = Math.floor(driver.lapTime / 60);
                const lapTimeSeconds = (driver.lapTime % 60).toFixed(3);
                const lapTimeText = `${lapTimeMinutes}:${lapTimeSeconds.padStart(6, '0')}`;

                driverElement.innerHTML = `
                    <div class="driver-position">${driver.position}</div>
                    <div class="driver-name">${driver.name}</div>
                    <div class="driver-lap">L${driver.currentLap} - ${lapTimeText}</div>
                `;

                leaderboard.appendChild(driverElement);
            });
        }

        function updateCarPosition(position) {
            const car = document.getElementById('car-position');
            car.style.left = position.x + 'px';
            car.style.top = position.y + 'px';
        }

        function generatePredictedPath(currentPos) {
            // Add current position to predicted path
            telemetryGen.predictedPath.push({
                ...currentPos,
                timestamp: Date.now()
            });

            // Keep only recent points (last 2 seconds)
            const now = Date.now();
            telemetryGen.predictedPath = telemetryGen.predictedPath.filter(
                point => now - point.timestamp < 2000
            );

            // Clear old predicted path elements
            document.querySelectorAll('.predicted-path').forEach(el => el.remove());

            // Draw predicted path
            telemetryGen.predictedPath.forEach((point, index) => {
                const pathElement = document.createElement('div');
                pathElement.className = 'predicted-path';
                pathElement.style.left = point.x + 'px';
                pathElement.style.top = point.y + 'px';
                pathElement.style.opacity = (index / telemetryGen.predictedPath.length) * 0.7;
                document.querySelector('.track-container').appendChild(pathElement);
            });
        }

        // Main update loop
        function updateDashboard() {
            const data = telemetryGen.generateTelemetry();
            updateTelemetry(data);
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initTrack();
            setInterval(updateDashboard, 100); // Update every 100ms
        });
    </script>
</body>
</html>